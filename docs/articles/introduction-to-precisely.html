<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to Precisely • precisely</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to Precisely">
<meta property="og:description" content="precisely">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">precisely</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="..//reference/index.html">Reference</a>
</li>
<li>
  <a href="..//articles/introduction-to-precisely.html">An Introduction to precisely</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/malcolmbarrett/precisely/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to Precisely</h1>
                        <h4 class="author">Malcolm Barrett</h4>
            
            <h4 class="date">2020-06-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/malcolmbarrett/precisely/blob/master/vignettes/introduction-to-precisely.Rmd"><code>vignettes/introduction-to-precisely.Rmd</code></a></small>
      <div class="hidden name"><code>introduction-to-precisely.Rmd</code></div>

    </div>

    
    
<div id="estimating-for-precision" class="section level2">
<h2 class="hasAnchor">
<a href="#estimating-for-precision" class="anchor"></a>Estimating for precision</h2>
<p>precisely is a study planning tool to calculate sample size based on precision rather than power. Power calculations are focused on whether or not an estimate will be statistically significant; calculations of precision are based on the same principles as power calculation but turn the focus to the width of the confidence interval.</p>
<p>These tools are based on the work of <a href="https://www.ncbi.nlm.nih.gov/pubmed/29912015">Rothman and Greenland</a>.</p>
<p>precisely has functions for studies using risk differences, risk ratios, rate differences, rate ratios, and odds ratios. The heart of these calculations is the desired precision. For ratio measures, this is the ratio of the upper to lower limit of the confidence interval. For difference measures, this is the absolute width of the confidence interval. To calculate sample size for a given precision, you also need proportions for the two groups (the risk or rate in the exposed and unexposed participants in a cohort study or the exposure prevalence in the cases and controls in case-control studies), the ratios of the two groups (the unexposed to the exposed in cohort studies or controls to cases in case-control studies), and the desired confidence interval probability. The default is 95%.</p>
<p>Let’s say we want to calculate the sample size needed to estimate a 90% CI for a risk difference of .1 with an absolute width of .08. Here, the risk among the exposed is .4, the risk among the unexposed is .3, and there are three times as many unexposed participants.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">purrr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">precisely</span>)

<span class="fu"><a href="../reference/n_risk_difference.html">n_risk_difference</a></span>(
  <span class="kw">precision</span> <span class="kw">=</span> <span class="fl">.08</span>,
  <span class="kw">exposed</span> <span class="kw">=</span> <span class="fl">.4</span>,
  <span class="kw">unexposed</span> <span class="kw">=</span> <span class="fl">.3</span>,
  <span class="kw">group_ratio</span> <span class="kw">=</span> <span class="fl">3</span>,
  <span class="kw">ci</span> <span class="kw">=</span> <span class="fl">.90</span>
)
<span class="co">#&gt; # A tibble: 1 x 9</span>
<span class="co">#&gt;   n_exposed n_unexposed n_total risk_difference precision exposed unexposed</span>
<span class="co">#&gt;       &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt; 1      524.       1573.   2097.             0.1      0.08     0.4       0.3</span>
<span class="co">#&gt; # … with 2 more variables: group_ratio &lt;dbl&gt;, ci &lt;dbl&gt;</span></pre></body></html></div>
<p>We need 525 exposed participants and 1,573 unexposed participants for a total sample size of 2,098. For the same population, what sample size would we need to estimate a risk ratio where the upper bound of a 95% CI has a ratio of 2 with the lower bound?</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="../reference/n_risk_difference.html">n_risk_ratio</a></span>(
  <span class="kw">precision</span> <span class="kw">=</span> <span class="fl">2</span>,
  <span class="kw">exposed</span> <span class="kw">=</span> <span class="fl">.4</span>,
  <span class="kw">unexposed</span> <span class="kw">=</span> <span class="fl">.3</span>,
  <span class="kw">group_ratio</span> <span class="kw">=</span> <span class="fl">3</span>
)
<span class="co">#&gt; # A tibble: 1 x 9</span>
<span class="co">#&gt;   n_exposed n_unexposed n_total risk_ratio precision exposed unexposed</span>
<span class="co">#&gt;       &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt; 1      72.8        219.    291.       1.33         2     0.4       0.3</span>
<span class="co">#&gt; # … with 2 more variables: group_ratio &lt;dbl&gt;, ci &lt;dbl&gt;</span></pre></body></html></div>
<p>Here we only need 73 exposed participants and 219 unexposed participants, a total sample size of 292.</p>
</div>
<div id="estimating-precision-for-a-sample-size" class="section level2">
<h2 class="hasAnchor">
<a href="#estimating-precision-for-a-sample-size" class="anchor"></a>Estimating Precision for a Sample Size</h2>
<p>precisely also provides functionality to calculate the precision of an estimate given a sample size. For instance, in a case-control study with 500 cases, 1,000 controls and prevalences among the cases and controls of .6 and .4, respectively, what is the ratio of the upper bound to the lower bound?</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="../reference/precision_risk_difference.html">precision_odds_ratio</a></span>(
  <span class="kw">n_cases</span> <span class="kw">=</span> <span class="fl">500</span>,
  <span class="kw">exposed_cases</span> <span class="kw">=</span> <span class="fl">.6</span>,
  <span class="kw">exposed_controls</span> <span class="kw">=</span> <span class="fl">.4</span>,
  <span class="kw">group_ratio</span> <span class="kw">=</span> <span class="fl">2</span>
)
<span class="co">#&gt; # A tibble: 1 x 9</span>
<span class="co">#&gt;   precision odds_ratio n_cases n_controls n_total exposed_cases exposed_controls</span>
<span class="co">#&gt;       &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;         &lt;dbl&gt;            &lt;dbl&gt;</span>
<span class="co">#&gt; 1      1.55       2.25     500       1000    1500           0.6              0.4</span>
<span class="co">#&gt; # … with 2 more variables: group_ratio &lt;dbl&gt;, ci &lt;dbl&gt;</span></pre></body></html></div>
<p>We can expect that, on average, the upper confidence interval will be 1.55 times as large as the lower confidence interval.</p>
</div>
<div id="probability-that-upper-limit-is-below-level-of-concern" class="section level2">
<h2 class="hasAnchor">
<a href="#probability-that-upper-limit-is-below-level-of-concern" class="anchor"></a>Probability that upper limit is below level of concern</h2>
<p>precisely also has a set of functions for a different way of using precision: to calculate sample size based on probability that the upper limit of the confidence interval is below a level of concern. The idea here is that, if there is no true effect, we want to know how likely it is that we have a high estimate. For instance, for a rate ratio where the effect is null, we can calculate the sample size for which there is a 90% probability that the upper limit will be at or below 2.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="../reference/upper_risk_difference.html">upper_rate_ratio</a></span>(
  <span class="kw">upper_limit</span> <span class="kw">=</span> <span class="fl">2</span>,
  <span class="kw">prob</span> <span class="kw">=</span> <span class="fl">.90</span>,
  <span class="kw">exposed</span> <span class="kw">=</span> <span class="fl">.01</span>,
  <span class="kw">unexposed</span> <span class="kw">=</span> <span class="fl">.01</span>,
  <span class="kw">group_ratio</span> <span class="kw">=</span> <span class="fl">1</span>
)
<span class="co">#&gt; # A tibble: 1 x 10</span>
<span class="co">#&gt;   n_exposed n_unexposed n_total rate_ratio upper_limit  prob exposed unexposed</span>
<span class="co">#&gt;       &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt; 1     4374.       4374.   8748.          1           2   0.9    0.01      0.01</span>
<span class="co">#&gt; # … with 2 more variables: group_ratio &lt;dbl&gt;, ci &lt;dbl&gt;</span></pre></body></html></div>
</div>
<div id="mapping-and-plotting-with-precisely" class="section level1">
<h1 class="hasAnchor">
<a href="#mapping-and-plotting-with-precisely" class="anchor"></a>Mapping and Plotting with precisely</h1>
<p>To calculate several values and plot them, use <code><a href="../reference/map_precisely.html">map_precisely()</a></code> and the included <code>plot_*()</code> functions and <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">dplyr::group_by()</a></code> to set the variable for the color aesthetic.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="../reference/map_precisely.html">map_precisely</a></span>(
  <span class="no">precision_odds_ratio</span>,
  <span class="kw">n_cases</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="fl">500</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="fl">1000</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="fl">10</span>),
  <span class="kw">exposed_cases</span> <span class="kw">=</span> <span class="fl">.6</span>,
  <span class="kw">exposed_controls</span> <span class="kw">=</span> <span class="fl">.4</span>,
  <span class="kw">group_ratio</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">4</span>
) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="st">"Control/Case Ratio"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">group_ratio</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/plot_sample_size.html">plot_precision</a></span>()</pre></body></html></div>
<p><img src="introduction-to-precisely_files/figure-html/unnamed-chunk-5-1.png" width="1920" style="display: block; margin: auto;"></p>
<p>Since the plotting functions are just ggplots, they are easy to customize. precisely also has a minimalist theme for ggplots, <code><a href="../reference/theme_precisely.html">theme_precisely()</a></code>.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="../reference/map_precisely.html">map_precisely</a></span>(
  <span class="no">upper_rate_ratio</span>,
  <span class="kw">upper_limit</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="fl">.1</span>),
  <span class="kw">prob</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">.50</span>, <span class="fl">.95</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="fl">.05</span>),
  <span class="kw">exposed</span> <span class="kw">=</span> <span class="fl">.01</span>,
  <span class="kw">unexposed</span> <span class="kw">=</span> <span class="fl">.01</span>,
  <span class="kw">group_ratio</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">4</span>
 ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="st">"Probability"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">prob</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/plot_sample_size.html">plot_upper_limit</a></span>(<span class="kw">line_size</span> <span class="kw">=</span> <span class="fl">1</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span>(<span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20000</span>, <span class="fl">40000</span>)) +
    <span class="fu"><a href="../reference/theme_precisely.html">theme_precisely</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"right"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(~ <span class="no">group_ratio</span>,
               <span class="kw">labeller</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/as_labeller.html">as_labeller</a></span>(<span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Unexposed/Exposed:"</span>, <span class="no">x</span>)))</pre></body></html></div>
<p><img src="introduction-to-precisely_files/figure-html/unnamed-chunk-6-1.png" width="1920" style="display: block; margin: auto;"></p>
<p><code><a href="../reference/map_precisely.html">map_precisely()</a></code> is just a thin wrapper around <code><a href="https://tidyr.tidyverse.org/reference/expand.html">tidyr::crossing()</a></code> and <code><a href="https://purrr.tidyverse.org/reference/map2.html">purrr::pmap_dfr()</a></code>. <code><a href="https://purrr.tidyverse.org/reference/map2.html">purrr::pmap_dfr()</a></code> takes a data frame where the column names correspond to the arguments in the function. <code><a href="https://tidyr.tidyverse.org/reference/expand.html">tidyr::crossing()</a></code> takes the arguments and makes all possible combinations. Likewise, the plotting functions are primarily wrappers around ggplots with <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code>. It’s easy, then, to create create them from scratch.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">arguments</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html">crossing</a></span>(
  <span class="kw">precision</span> <span class="kw">=</span> <span class="fl">2</span>,
  <span class="kw">exposed</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="fl">.01</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="fl">.05</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="fl">.005</span>),
  <span class="kw">unexposed</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="fl">.01</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="fl">.05</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="fl">.005</span>),
  <span class="kw">group_ratio</span> <span class="kw">=</span> <span class="fl">1</span>
)

<span class="no">arguments</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">pmap_dfr</a></span>(<span class="no">n_rate_ratio</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(<span class="no">key</span>, <span class="no">value</span>, <span class="no">exposed</span>, <span class="no">unexposed</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">n_total</span>, <span class="no">rate_ratio</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">value</span>))) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">1.1</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(~<span class="no">key</span>, <span class="kw">labeller</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/as_labeller.html">as_labeller</a></span>(<span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Risk among"</span>, <span class="no">x</span>))) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(
      <span class="kw">title</span> <span class="kw">=</span> <span class="st">"n Needed for an Upper to Lower CI Ratio of 2"</span>,
      <span class="kw">x</span> <span class="kw">=</span> <span class="st">"Sample Size"</span>,
      <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Rate Ratio"</span>,
      <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Risk"</span>
     ) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span>(<span class="fl">14</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(
      <span class="kw">plot.title</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">margin</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span>(<span class="fl">.01</span>, <span class="fl">.01</span>, <span class="fl">.01</span>, <span class="fl">.01</span>)),
      <span class="kw">strip.text</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">16</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"grey50"</span>, <span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">0</span>)
    )</pre></body></html></div>
<p><img src="introduction-to-precisely_files/figure-html/unnamed-chunk-7-1.png" width="2240" style="display: block; margin: auto;"></p>
<p>You can also be more exact in the argument values by creating your own data frames. Here’s an example recreating the figure from Rothman and Greenland’s paper.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">lower_risk</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/reexports.html">tibble</a></span>(
  <span class="kw">precision</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="fl">.02</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="fl">.20</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="fl">.005</span>),
  <span class="kw">exposed</span> <span class="kw">=</span> <span class="fl">.2</span>,
  <span class="kw">unexposed</span> <span class="kw">=</span> <span class="fl">.1</span>,
  <span class="kw">group_ratio</span> <span class="kw">=</span> <span class="fl">1</span>
)

<span class="no">higher_risk</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/reexports.html">tibble</a></span>(
  <span class="kw">precision</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="fl">.02</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="fl">.20</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="fl">.005</span>),
  <span class="kw">exposed</span> <span class="kw">=</span> <span class="fl">.4</span>,
  <span class="kw">unexposed</span> <span class="kw">=</span> <span class="fl">.3</span>,
  <span class="kw">group_ratio</span> <span class="kw">=</span> <span class="fl">1</span>
)


<span class="no">risk_difference_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span>(<span class="no">lower_risk</span>, <span class="no">higher_risk</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">pmap_dfr</a></span>(<span class="no">n_risk_difference</span>)

<span class="no">risk_difference_data</span>
<span class="co">#&gt; # A tibble: 74 x 9</span>
<span class="co">#&gt;    n_exposed n_unexposed n_total risk_difference precision exposed unexposed</span>
<span class="co">#&gt;        &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt;  1     9604.       9604.  19207.             0.1     0.02      0.2       0.1</span>
<span class="co">#&gt;  2     6146.       6146.  12293.             0.1     0.025     0.2       0.1</span>
<span class="co">#&gt;  3     4268.       4268.   8537.             0.1     0.03      0.2       0.1</span>
<span class="co">#&gt;  4     3136.       3136.   6272.             0.1     0.035     0.2       0.1</span>
<span class="co">#&gt;  5     2401.       2401.   4802.             0.1     0.04      0.2       0.1</span>
<span class="co">#&gt;  6     1897.       1897.   3794.             0.1     0.045     0.2       0.1</span>
<span class="co">#&gt;  7     1537.       1537.   3073.             0.1     0.05      0.2       0.1</span>
<span class="co">#&gt;  8     1270.       1270.   2540.             0.1     0.055     0.2       0.1</span>
<span class="co">#&gt;  9     1067.       1067.   2134.             0.1     0.06      0.2       0.1</span>
<span class="co">#&gt; 10      909.        909.   1818.             0.1     0.065     0.2       0.1</span>
<span class="co">#&gt; # … with 64 more rows, and 2 more variables: group_ratio &lt;dbl&gt;, ci &lt;dbl&gt;</span></pre></body></html></div>
<p>While the plotting functions support all the calculation functions in precisely, it’s easy to replicate in raw ggplot.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">rg_plot</span> <span class="kw">&lt;-</span> <span class="no">risk_difference_data</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">n_total</span>, <span class="no">precision</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">unexposed</span>))) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">1.1</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">9000</span>))

<span class="no">rg_plot</span></pre></body></html></div>
<p><img src="introduction-to-precisely_files/figure-html/unnamed-chunk-9-1.png" width="1920" style="display: block; margin: auto;"></p>
<p>Of course, the real power of combining this package with ggplot is to customize it.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">rg_plot</span> +
    <span class="kw pkg">ggrepel</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span>( <span class="kw">col</span> <span class="kw">=</span> <span class="st">"grey30"</span>,
      <span class="kw">data</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">x</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/near.html">near</a></span>(<span class="no">n_total</span>, <span class="fl">2500</span>, <span class="fl">100</span>)),
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">label</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Risk in Unexposed:"</span>, <span class="no">unexposed</span>)),
      <span class="kw">size</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">segment.size</span> <span class="kw">=</span> <span class="fl">.5</span>,
      <span class="kw">nudge_x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">900</span>, <span class="fl">1100</span>),
      <span class="kw">nudge_y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">.015</span>, <span class="fl">.03</span>),
     ) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(
      <span class="kw">x</span> <span class="kw">=</span> <span class="st">"Study Size"</span>,
      <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Confidence Interval Width"</span>,
      <span class="kw">color</span> <span class="kw">=</span> <span class="st">"Risk in\nUnexposed"</span>
     ) +
    <span class="fu"><a href="../reference/theme_precisely.html">theme_precisely</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"none"</span>,
          <span class="kw">plot.title</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">16</span>),
          <span class="kw">plot.subtitle</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">12</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"grey60"</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>))</pre></body></html></div>
<p><img src="introduction-to-precisely_files/figure-html/unnamed-chunk-10-1.png" width="1920" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://malco.io">Malcolm Barrett</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
